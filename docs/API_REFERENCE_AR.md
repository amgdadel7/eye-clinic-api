# مرجع واجهة برمجة التطبيقات

مرجع كامل لجميع نقاط نهاية واجهة برمجة التطبيقات في واجهة برمجة تطبيقات عيادة العيون.

## رابط الأساسي

- التطوير: `http://localhost:5000/api`
- الإنتاج: `https://your-domain.com/api`

## المصادقة

معظم نقاط النهاية تتطلب المصادقة باستخدام رموز JWT. قم بتضمين الرمز في رأس Authorization:

```
Authorization: Bearer <token>
```

## تنسيق الاستجابة

### استجابة النجاح
```json
{
  "success": true,
  "message": "تمت العملية بنجاح",
  "data": { ... }
}
```

### استجابة الخطأ
```json
{
  "success": false,
  "message": "رسالة الخطأ"
}
```

## رموز الحالة

- `200` - نجاح
- `201` - تم الإنشاء
- `400` - طلب غير صحيح
- `401` - غير مصرح
- `403` - محظور
- `404` - غير موجود
- `500` - خطأ في الخادم

---

## نقاط نهاية المصادقة

### POST `/api/auth/register-clinic`
تسجيل عيادة جديدة.

**هيكل الطلب:**
```json
{
  "name": "اسم العيادة",
  "email": "clinic@example.com",
  "password": "password123",
  "code": "CLINIC001",
  "license": "LIC123",
  "phone": "1234567890",
  "address": "عنوان العيادة"
}
```

**الاستجابة:** `201 Created`

---

### POST `/api/auth/register-user`
تسجيل مستخدم جديد (مدير، طبيب، أو موظف استقبال).

**هيكل الطلب:**
```json
{
  "name": "اسم المستخدم",
  "email": "user@example.com",
  "password": "password123",
  "phone": "1234567890",
  "role": "doctor",
  "clinicId": 1
}
```

**الاستجابة:** `201 Created`

---

### POST `/api/auth/login`
تسجيل الدخول والحصول على رمز JWT.

**هيكل الطلب:**
```json
{
  "email": "user@example.com",
  "password": "password123"
}
```

**الاستجابة:** `200 OK`
```json
{
  "success": true,
  "token": "jwt_token_here",
  "user": { ... }
}
```

---

### GET `/api/auth/me`
الحصول على ملف المستخدم الحالي (يتطلب المصادقة).

**الرؤوس:**
```
Authorization: Bearer <token>
```

**الاستجابة:** `200 OK`

---

### PUT `/api/auth/update-profile`
تحديث ملف المستخدم (يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

## نقاط نهاية العيادات

### GET `/api/clinics`
الحصول على جميع العيادات.

**الاستجابة:** `200 OK`

---

### GET `/api/clinics/:id`
الحصول على عيادة حسب المعرف.

**الاستجابة:** `200 OK`

---

### GET `/api/clinics/:id/doctors`
الحصول على جميع الأطباء في عيادة.

**الاستجابة:** `200 OK`

---

### PUT `/api/clinics/:id`
تحديث العيادة (يتطلب مصادقة المدير).

**الاستجابة:** `200 OK`

---

## نقاط نهاية المرضى

### GET `/api/patients`
الحصول على جميع المرضى (يتطلب المصادقة).

**معاملات الاستعلام:**
- `page` - رقم الصفحة
- `limit` - العناصر لكل صفحة
- `search` - مصطلح البحث

**الاستجابة:** `200 OK`

---

### GET `/api/patients/:id`
الحصول على مريض حسب المعرف (يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### POST `/api/patients`
إنشاء مريض جديد (يتطلب مصادقة المدير أو موظف الاستقبال).

**هيكل الطلب:**
```json
{
  "name": "اسم المريض",
  "phone": "1234567890",
  "email": "patient@example.com",
  "age": 30,
  "gender": "male",
  "dateOfBirth": "1993-01-01",
  "address": "عنوان المريض"
}
```

**الاستجابة:** `201 Created`

---

### PUT `/api/patients/:id`
تحديث المريض (يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### DELETE `/api/patients/:id`
حذف المريض (يتطلب مصادقة المدير).

**الاستجابة:** `200 OK`

---

## نقاط نهاية الأطباء

### GET `/api/doctors`
الحصول على جميع الأطباء.

**الاستجابة:** `200 OK`

---

### GET `/api/doctors/:id`
الحصول على طبيب حسب المعرف.

**الاستجابة:** `200 OK`

---

### POST `/api/doctors`
إنشاء طبيب جديد (يتطلب مصادقة المدير).

**هيكل الطلب:**
```json
{
  "userId": 1,
  "doctorId": "DOC001",
  "specialization": "طب العيون",
  "clinicId": 1,
  "licenseNumber": "LIC123"
}
```

**الاستجابة:** `201 Created`

---

### PUT `/api/doctors/:id`
تحديث الطبيب.

**الاستجابة:** `200 OK`

---

### GET `/api/doctors/:id/schedule`
الحصول على جدول الطبيب.

**الاستجابة:** `200 OK`

---

### PUT `/api/doctors/:id/schedule`
تحديث جدول الطبيب.

**الاستجابة:** `200 OK`

---

### DELETE `/api/doctors/:id`
حذف الطبيب (يتطلب مصادقة المدير).

**الاستجابة:** `200 OK`

---

## نقاط نهاية المواعيد

### GET `/api/appointments`
الحصول على جميع المواعيد (يتطلب المصادقة).

**معاملات الاستعلام:**
- `date` - تصفية حسب التاريخ
- `doctorId` - تصفية حسب الطبيب
- `status` - تصفية حسب الحالة

**الاستجابة:** `200 OK`

---

### GET `/api/appointments/today`
الحصول على مواعيد اليوم (يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### GET `/api/appointments/doctor/:doctorId`
الحصول على مواعيد طبيب محدد (يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### GET `/api/appointments/available-slots`
الحصول على فترات المواعيد المتاحة (يتطلب المصادقة).

**معاملات الاستعلام:**
- `doctorId` - معرف الطبيب
- `date` - التاريخ (YYYY-MM-DD)

**الاستجابة:** `200 OK`

---

### GET `/api/appointments/:id`
الحصول على موعد حسب المعرف (يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### POST `/api/appointments`
إنشاء موعد جديد (يتطلب المصادقة).

**هيكل الطلب:**
```json
{
  "patientId": 1,
  "doctorId": 1,
  "appointmentDate": "2024-01-15",
  "appointmentTime": "10:00:00",
  "reason": "فحص العيون"
}
```

**الاستجابة:** `201 Created`

---

### POST `/api/appointments/suggest-time`
اقتراح وقت موعد متاح (يتطلب المصادقة).

**هيكل الطلب:**
```json
{
  "doctorId": 1,
  "preferredDate": "2024-01-15"
}
```

**الاستجابة:** `200 OK`

---

### PUT `/api/appointments/:id`
تحديث الموعد (يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### DELETE `/api/appointments/:id`
حذف الموعد (يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

## نقاط نهاية الوصفات

### GET `/api/prescriptions`
الحصول على جميع الوصفات (يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### GET `/api/prescriptions/patient/:patientId`
الحصول على وصفات مريض (يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### GET `/api/prescriptions/:id`
الحصول على وصفة حسب المعرف (يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### POST `/api/prescriptions`
إنشاء وصفة جديدة (يتطلب مصادقة الطبيب أو المدير).

**هيكل الطلب:**
```json
{
  "patientId": 1,
  "doctorId": 1,
  "medications": [
    {
      "name": "قطرة العين",
      "dosage": "قطرتان",
      "frequency": "مرتين يومياً"
    }
  ],
  "instructions": "استخدم حسب التعليمات"
}
```

**الاستجابة:** `201 Created`

---

### PUT `/api/prescriptions/:id`
تحديث الوصفة (يتطلب مصادقة الطبيب أو المدير).

**الاستجابة:** `200 OK`

---

### DELETE `/api/prescriptions/:id`
حذف الوصفة (يتطلب مصادقة الطبيب أو المدير).

**الاستجابة:** `200 OK`

---

## نقاط نهاية التقارير الطبية

### GET `/api/medical-reports`
الحصول على جميع التقارير الطبية (يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### GET `/api/medical-reports/patient/:patientId`
الحصول على تقارير مريض (يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### GET `/api/medical-reports/:id`
الحصول على تقرير حسب المعرف (يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### POST `/api/medical-reports`
إنشاء تقرير طبي جديد (يتطلب مصادقة الطبيب أو المدير).

**هيكل الطلب:**
```json
{
  "patientId": 1,
  "doctorId": 1,
  "reportType": "فحص",
  "findings": "فحص عيون طبيعي",
  "diagnosis": "صحة جيدة",
  "recommendations": "فحص دوري"
}
```

**الاستجابة:** `201 Created`

---

### PUT `/api/medical-reports/:id`
تحديث التقرير الطبي (يتطلب مصادقة الطبيب أو المدير).

**الاستجابة:** `200 OK`

---

### DELETE `/api/medical-reports/:id`
حذف التقرير الطبي (يتطلب مصادقة الطبيب أو المدير).

**الاستجابة:** `200 OK`

---

## نقاط نهاية نتائج الاختبارات

### GET `/api/test-results`
الحصول على جميع نتائج الاختبارات (يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### GET `/api/test-results/patient/:patientId`
الحصول على نتائج اختبارات مريض (يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### GET `/api/test-results/:id`
الحصول على نتيجة اختبار حسب المعرف (يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### POST `/api/test-results`
إنشاء نتيجة اختبار جديدة (يتطلب مصادقة الطبيب أو المدير).

**الاستجابة:** `201 Created`

---

### PUT `/api/test-results/:id`
تحديث نتيجة الاختبار (يتطلب مصادقة الطبيب أو المدير).

**الاستجابة:** `200 OK`

---

### DELETE `/api/test-results/:id`
حذف نتيجة الاختبار (يتطلب مصادقة الطبيب أو المدير).

**الاستجابة:** `200 OK`

---

## نقاط نهاية اختبارات الألوان

### GET `/api/color-tests`
الحصول على جميع اختبارات الألوان (يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### GET `/api/color-tests/:id`
الحصول على اختبار ألوان حسب المعرف (يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### POST `/api/color-tests`
إنشاء اختبار ألوان جديد (يتطلب مصادقة المدير أو الطبيب).

**هيكل الطلب:**
```json
{
  "testNumber": 1,
  "imageUrl": "path/to/image.png",
  "correctAnswer": "12",
  "questionType": "number"
}
```

**الاستجابة:** `201 Created`

---

### PUT `/api/color-tests/:id`
تحديث اختبار الألوان (يتطلب مصادقة المدير أو الطبيب).

**الاستجابة:** `200 OK`

---

### DELETE `/api/color-tests/:id`
حذف اختبار الألوان (يتطلب مصادقة المدير).

**الاستجابة:** `200 OK`

---

## نقاط نهاية التحليلات

### GET `/api/analytics`
الحصول على نظرة عامة على التحليلات (يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### GET `/api/analytics/dashboard`
الحصول على إحصائيات لوحة التحكم (يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### GET `/api/analytics/patients`
الحصول على إحصائيات المرضى (يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### GET `/api/analytics/appointments`
الحصول على إحصائيات المواعيد (يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### GET `/api/analytics/revenue`
الحصول على إحصائيات الإيرادات (يتطلب مصادقة المدير).

**الاستجابة:** `200 OK`

---

## نقاط نهاية غرفة الانتظار

### GET `/api/waiting-room`
الحصول على قائمة الانتظار (يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### POST `/api/waiting-room/check-in`
تسجيل دخول مريض إلى غرفة الانتظار (يتطلب المصادقة).

**هيكل الطلب:**
```json
{
  "patientId": 1,
  "appointmentId": 1
}
```

**الاستجابة:** `201 Created`

---

### PUT `/api/waiting-room/:id/status`
تحديث حالة غرفة الانتظار (يتطلب المصادقة).

**هيكل الطلب:**
```json
{
  "status": "in_progress"
}
```

**الاستجابة:** `200 OK`

---

### DELETE `/api/waiting-room/:id`
إزالة مريض من غرفة الانتظار (يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

## نقاط نهاية إدارة المستخدمين

### GET `/api/users`
الحصول على جميع المستخدمين (يتطلب مصادقة المدير).

**الاستجابة:** `200 OK`

---

### GET `/api/users/pending`
الحصول على المستخدمين المعلقة (يتطلب مصادقة المدير).

**الاستجابة:** `200 OK`

---

### PUT `/api/users/:id/approve`
الموافقة على مستخدم (يتطلب مصادقة المدير).

**الاستجابة:** `200 OK`

---

### PUT `/api/users/:id/reject`
رفض مستخدم (يتطلب مصادقة المدير).

**الاستجابة:** `200 OK`

---

### PUT `/api/users/:id`
تحديث المستخدم.

**الاستجابة:** `200 OK`

---

### DELETE `/api/users/:id`
حذف مستخدم (يتطلب مصادقة المدير).

**الاستجابة:** `200 OK`

---

## نقاط نهاية واجهة برمجة تطبيقات المحمول

### POST `/api/mobile/auth/register`
تسجيل مريض (المحمول).

**هيكل الطلب:**
```json
{
  "name": "اسم المريض",
  "phone": "1234567890",
  "email": "patient@example.com",
  "password": "password123"
}
```

**الاستجابة:** `201 Created`

---

### POST `/api/mobile/auth/login`
تسجيل دخول المريض (المحمول).

**هيكل الطلب:**
```json
{
  "phone": "1234567890",
  "password": "password123"
}
```

**الاستجابة:** `200 OK`

---

### GET `/api/mobile/auth/profile`
الحصول على ملف المريض (يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### POST `/api/mobile/appointments/book`
حجز موعد (المحمول، يتطلب المصادقة).

**الاستجابة:** `201 Created`

---

### GET `/api/mobile/appointments/my-appointments`
الحصول على مواعيد المريض (المحمول، يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### GET `/api/mobile/appointments/available-slots`
الحصول على الفترات المتاحة (المحمول، يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### PUT `/api/mobile/appointments/:id/cancel`
إلغاء موعد (المحمول، يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### GET `/api/mobile/color-tests/all`
الحصول على جميع اختبارات الألوان (المحمول، يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### POST `/api/mobile/color-tests/submit-answers`
إرسال إجابات اختبار الألوان (المحمول، يتطلب المصادقة).

**هيكل الطلب:**
```json
{
  "testId": 1,
  "answers": {
    "1": "12",
    "2": "8"
  }
}
```

**الاستجابة:** `200 OK`

---

### GET `/api/mobile/color-tests/my-results`
الحصول على نتائج اختبارات المريض (المحمول، يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### GET `/api/mobile/prescriptions/my-prescriptions`
الحصول على وصفات المريض (المحمول، يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### GET `/api/mobile/medical-reports/my-reports`
الحصول على تقارير المريض (المحمول، يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### GET `/api/mobile/test-results/my-results`
الحصول على نتائج اختبارات المريض (المحمول، يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

## نقاط نهاية التقارير

### GET `/api/reports/daily`
الحصول على التقرير اليومي (يتطلب المصادقة).

**معاملات الاستعلام:**
- `date` - التاريخ (YYYY-MM-DD)

**الاستجابة:** `200 OK`

---

### GET `/api/reports/monthly`
الحصول على التقرير الشهري (يتطلب المصادقة).

**معاملات الاستعلام:**
- `year` - السنة
- `month` - الشهر

**الاستجابة:** `200 OK`

---

## نقاط نهاية واجهة المستخدم والإعدادات

### GET `/api/ui/sidebar`
الحصول على تكوين الشريط الجانبي.

**الاستجابة:** `200 OK`

---

### GET `/api/ui/header`
الحصول على معلومات ملف الرأس.

**الاستجابة:** `200 OK`

---

### GET `/api/settings/ui`
الحصول على إعدادات واجهة المستخدم.

**الاستجابة:** `200 OK`

---

### PUT `/api/settings/ui`
تحديث إعدادات واجهة المستخدم.

**الاستجابة:** `200 OK`

---

### GET `/api/user-settings`
الحصول على إعدادات المستخدم (يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

### PUT `/api/user-settings`
تحديث إعدادات المستخدم (يتطلب المصادقة).

**الاستجابة:** `200 OK`

---

## فحص الصحة

### GET `/health`
نقطة نهاية فحص الصحة.

**الاستجابة:** `200 OK`
```json
{
  "status": "OK",
  "timestamp": "2024-01-01T00:00:00.000Z",
  "service": "Eye Clinic API"
}
```

---

## تحديد المعدل

طلبات واجهة برمجة التطبيقات محدودة بمعدل 100 طلب لكل 15 دقيقة لكل عنوان IP.

## توثيق Swagger

التوثيق التفاعلي لواجهة برمجة التطبيقات متاح على `/api-docs` عند تشغيل الخادم.

