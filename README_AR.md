# واجهة برمجة تطبيقات عيادة العيون

واجهة برمجة تطبيقات REST شاملة لإدارة نظام عيادة العيون، بما في ذلك إدارة المرضى والمواعيد والوصفات الطبية والتقارير الطبية واختبارات عمى الألوان.

## نظرة عامة

واجهة برمجة تطبيقات عيادة العيون هي خدمة خلفية مبنية على Node.js/Express توفر نقاط نهاية لـ:
- إدارة العيادات والمستخدمين
- تسجيل المرضى وإدارتهم
- جدولة المواعيد
- الوصفات الطبية والتقارير الطبية
- اختبارات عمى الألوان (اختبارات إيشيهارا)
- التحليلات والتقارير
- دعم تطبيقات الهاتف المحمول

## المميزات

- **المصادقة والتفويض**: مصادقة قائمة على JWT مع تحكم في الوصول حسب الأدوار
- **دعم متعدد العيادات**: إدارة عيادات متعددة مع مستخدمين مختلفين
- **إدارة المرضى**: إدارة كاملة لملفات المرضى
- **نظام المواعيد**: جدولة وإدارة المواعيد مع فحص التوفر
- **السجلات الطبية**: الوصفات والتقارير الطبية ونتائج الاختبارات
- **اختبارات الألوان**: إدارة اختبارات عمى الألوان إيشيهارا
- **واجهة برمجة تطبيقات المحمول**: نقاط نهاية مخصصة لتطبيقات الهاتف المحمول
- **التحليلات**: إحصائيات لوحة التحكم والتقارير
- **توثيق Swagger**: توثيق تفاعلي لواجهة برمجة التطبيقات

## التقنيات المستخدمة

- **بيئة التشغيل**: Node.js 20.x
- **الإطار**: Express.js 4.18.2
- **قاعدة البيانات**: MySQL 8.0+
- **المصادقة**: JWT (jsonwebtoken)
- **التوثيق**: Swagger/OpenAPI
- **التحقق**: express-validator
- **الأمان**: bcryptjs, express-rate-limit

## البدء السريع

### المتطلبات الأساسية

- Node.js 20.x أو أحدث
- MySQL 8.0 أو أحدث
- npm أو yarn

### التثبيت

1. استنساخ المستودع:
```bash
git clone <repository-url>
cd eye-clinic-api
```

2. تثبيت التبعيات:
```bash
npm install
```

3. تكوين متغيرات البيئة:
قم بإنشاء ملف `.env` في المجلد الجذر:
```env
# إعدادات قاعدة البيانات
DB_HOST=localhost
DB_USER=root
DB_PASSWORD=your_password
DB_NAME=eye_clinic_db
DB_PORT=3306
DB_SSL=false

# إعدادات JWT
JWT_SECRET=your_secret_key_here
JWT_EXPIRES_IN=7d

# إعدادات الخادم
PORT=5000
NODE_ENV=development

# إعدادات CORS
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8080
```

4. إعداد قاعدة البيانات:
```bash
# استيراد المخطط
mysql -u root -p eye_clinic_db < database/schema.sql

# (اختياري) استيراد بيانات تجريبية
mysql -u root -p eye_clinic_db < database/sample_data.sql
```

5. تشغيل الخادم:
```bash
# وضع التطوير (مع إعادة التحميل التلقائي)
npm run dev

# وضع الإنتاج
npm start
```

ستكون واجهة برمجة التطبيقات متاحة على `http://localhost:5000`

## التوثيق

- **توثيق واجهة برمجة التطبيقات**: الوصول إلى واجهة Swagger على `http://localhost:5000/api-docs`
- **فحص الصحة**: `http://localhost:5000/health`

## هيكل المشروع

```
eye-clinic-api/
├── api/                 # نقاط دخول Vercel serverless
├── database/            # مخططات قاعدة البيانات والهجرات
├── scripts/             # البرامج المساعدة
├── src/
│   ├── config/         # ملفات التكوين
│   ├── controllers/    # معالجات الطلبات
│   ├── middleware/     # البرامج الوسيطة المخصصة
│   ├── routes/         # تعريفات مسارات واجهة برمجة التطبيقات
│   ├── utils/          # دوال مساعدة
│   ├── app.js          # تكوين تطبيق Express
│   └── server.js       # نقطة دخول الخادم
├── package.json
└── README.md
```

## نقاط نهاية واجهة برمجة التطبيقات

### النقاط الرئيسية

- `/api/auth` - المصادقة (تسجيل الدخول، التسجيل)
- `/api/clinics` - إدارة العيادات
- `/api/patients` - إدارة المرضى
- `/api/doctors` - إدارة الأطباء
- `/api/appointments` - جدولة المواعيد
- `/api/prescriptions` - إدارة الوصفات
- `/api/medical-reports` - إدارة التقارير الطبية
- `/api/test-results` - إدارة نتائج الاختبارات
- `/api/color-tests` - اختبارات عمى الألوان
- `/api/analytics` - التحليلات والإحصائيات
- `/api/mobile/*` - نقاط نهاية خاصة بالهاتف المحمول

للحصول على توثيق تفصيلي لواجهة برمجة التطبيقات، راجع [API_REFERENCE_AR.md](./docs/API_REFERENCE_AR.md)

## متغيرات البيئة

| المتغير | الوصف | القيمة الافتراضية |
|---------|-------|-------------------|
| `DB_HOST` | مضيف قاعدة البيانات | `localhost` |
| `DB_USER` | مستخدم قاعدة البيانات | `root` |
| `DB_PASSWORD` | كلمة مرور قاعدة البيانات | - |
| `DB_NAME` | اسم قاعدة البيانات | `eye_clinic_db` |
| `DB_PORT` | منفذ قاعدة البيانات | `3306` |
| `DB_SSL` | تفعيل SSL | `false` |
| `JWT_SECRET` | مفتاح JWT السري | - |
| `JWT_EXPIRES_IN` | انتهاء صلاحية JWT | `7d` |
| `PORT` | منفذ الخادم | `5000` |
| `NODE_ENV` | البيئة | `development` |
| `ALLOWED_ORIGINS` | مصادر CORS (مفصولة بفواصل) | - |

## التطوير

راجع [DEVELOPMENT_AR.md](./docs/DEVELOPMENT_AR.md) للحصول على إرشادات التطوير التفصيلية.

## النشر

راجع [DEPLOYMENT_AR.md](./docs/DEPLOYMENT_AR.md) للحصول على تعليمات النشر.

## الأمان

- المصادقة القائمة على JWT
- تشفير كلمات المرور باستخدام bcrypt
- تحديد معدل الطلبات على نقاط نهاية واجهة برمجة التطبيقات
- تكوين CORS
- التحقق من المدخلات

راجع [AUTHENTICATION_AR.md](./docs/AUTHENTICATION_AR.md) للحصول على تفاصيل الأمان.

## الترخيص

ISC

## الدعم

للإبلاغ عن المشكلات والأسئلة، يرجى الاتصال بفريق التطوير.

